# Munin Server

Docker container for [munin][1] monitoring.

Primarily created for unRAID server but has other use cases

[![Build Status](https://travis-ci.org/shaf/docker-munin-server.svg?branch=master)](https://travis-ci.org/shaf/docker-munin-server)

#### Contents

- munin
- munin node
- lm-sensors (assumes host drivers are loaded)
- apache

#### Configuration

Override environment and volume mappings

#### Environment

- `TZ`
	- Timezone (default: Europe/London)
- `HOSTNAME`
	- Rename Munin local hostname from localhost.localdomain (default: unRAID)
- `ALLOWED_HOSTS`
	- CIDR notation eg 192.168.1.0/24(class C) or 192.168.0.3/32(single host). Use If intending to monitor this host from an external munin server (default: 127.0.0.1/32)

#### Volumes

- `/var/cache/munin/www` : HTML/charts generated by munin
- `/var/lib/munin` : retention required for historic data
- `/etc/munin/munin-conf.d` : Additional user configuration for hosts, contacts etc

#### Container Ports

- 80 : Apache
- 4949 : munin-node

#### Build

```sh
docker build -t shaf/munin-server .
```

#### Usage

```sh
# Override environment to suit your needs
# Appdata volumes for persistent data

docker run -d --name=munin-server --net="bridge" \
	-e ALLOWED_HOSTS="0/0" \
	-e HOSTNAME="unRAID" \
	-e TZ="Europe/London" \
	-p 8888:80/tcp -p 4949:4949/tcp \
	-v /mnt/user/appdata/munin-server/www:/var/cache/munin/www:rw \
	-v /mnt/user/appdata/munin-server/rrd:/var/lib/munin:rw \
	-v /mnt/user/appdata/munin-server/conf:/etc/munin/munin-conf.d:rw \
	-v /:/rootfs:ro \
	-v /sys:/sys:ro shaf/munin-server

# Barebones without data retention

docker run -d --name=munin-server --net="bridge" \
	-p 8888:80/tcp \
	-v /:/rootfs:ro \
	-v /sys:/sys:ro shaf/munin-server
```

Munin interface accessible via http://host:8888/

#### To Do

- Enable more pluggins
- Remove or move logging (apache,munin)
- Remove services cron/apache2
- SMTP alerts
- Slimstream, compile into alpine linux

[1]: http://munin-monitoring.org/
